(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39130,88081,t=>{"use strict";var e=t.i(43476),n=t.i(71645);async function a(t,e={},n){let r=`${t}`,o={"Content-Type":"application/json",...e.headers||{}};n&&(o.Authorization=`Bearer ${n}`);let l=await fetch(r,{...e,headers:o,credentials:"include"}),s=(l.headers.get("content-type")||"").includes("application/json")?await l.json():await l.text();if(!l.ok)throw Error(s?.error||s||"Request failed");return s}t.i(47167),t.s(["apiFetch",()=>a],88081);let r=(0,n.createContext)(null);function o({children:t}){let[o,l]=(0,n.useState)(null),[s,u]=(0,n.useState)(null),[i,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let t=localStorage.getItem("synthesis_token");t?u(t):c(!1)},[]),(0,n.useEffect)(()=>{if(!s){l(null),c(!1);return}let t=!1;return async function(){try{let e=await a("/api/auth/me",{},s);t||l(e.user)}catch{t||(l(null),u(null),localStorage.removeItem("synthesis_token"))}finally{t||c(!1)}}(),()=>{t=!0}},[s]);let h=(0,n.useCallback)(async(t,e)=>{let n=await a("/api/auth/login",{method:"POST",body:JSON.stringify({email:t,password:e})});return localStorage.setItem("synthesis_token",n.token),u(n.token),l(n.user),n.user},[]),y=(0,n.useCallback)(async(t,e,n)=>{let r=await a("/api/auth/register",{method:"POST",body:JSON.stringify({email:t,password:e,name:n})});return localStorage.setItem("synthesis_token",r.token),u(r.token),l(r.user),r.user},[]),d=(0,n.useCallback)(async()=>{try{await a("/api/auth/logout",{method:"POST"},s)}catch{}localStorage.removeItem("synthesis_token"),u(null),l(null)},[s]);return(0,e.jsx)(r.Provider,{value:{user:o,token:s,loading:i,login:h,register:y,logout:d},children:t})}function l(){let t=(0,n.useContext)(r);if(!t)throw Error("useAuth must be used within AuthProvider");return t}t.s(["AuthProvider",()=>o,"useAuth",()=>l],39130)}]);